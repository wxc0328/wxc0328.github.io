<div class="post-meta">
  <!-- 发布日期 -->
  <span class="meta-item meta-date">
    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <rect width="18" height="18" x="3" y="4" rx="2" ry="2"></rect>
      <line x1="16" x2="16" y1="2" y2="6"></line>
      <line x1="8" x2="8" y1="2" y2="6"></line>
      <line x1="3" x2="21" y1="10" y2="10"></line>
    </svg>
    <time datetime="<%= date(post.date, 'YYYY-MM-DD') %>">
      <%= date(post.date, 'YYYY-MM-DD') %>
    </time>
  </span>

  <!-- 更新日期 -->
  <% if (typeof showFull !== 'undefined' && showFull && theme.post.show_updated && post.updated && post.updated.valueOf() !== post.date.valueOf()) { %>
    <span class="meta-item meta-updated">
      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"></path>
        <path d="M21 3v5h-5"></path>
      </svg>
      <time datetime="<%= date(post.updated, 'YYYY-MM-DD') %>">
        更新于 <%= date(post.updated, 'YYYY-MM-DD') %>
      </time>
    </span>
  <% } %>

  <!-- 字数统计 -->
  <% if (theme.post.word_count) { %>
    <span class="meta-item meta-wordcount">
      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M17 6.1H3"></path>
        <path d="M21 12.1H3"></path>
        <path d="M15.1 18H3"></path>
      </svg>
      <% 
        const content = strip_html(post.content);
        const wordCount = content.length;
        const displayCount = wordCount >= 1000 ? (wordCount / 1000).toFixed(1) + 'k' : wordCount;
      %>
      <%= displayCount %> 字
    </span>
  <% } %>

  <!-- 阅读时间 -->
  <% if (theme.post.reading_time) { %>
    <span class="meta-item meta-readtime">
      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <circle cx="12" cy="12" r="10"></circle>
        <polyline points="12 6 12 12 16 14"></polyline>
      </svg>
      <% 
        const wpm = theme.post.words_per_minute || 300;
        const text = strip_html(post.content);
        const minutes = Math.ceil(text.length / wpm);
      %>
      约 <%= minutes %> 分钟
    </span>
  <% } %>

  <!-- 标签（仅在列表页显示前几个） -->
  <% if (post.tags && post.tags.length && (typeof showFull === 'undefined' || !showFull)) { %>
    <span class="meta-item meta-tags">
      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z"></path>
        <path d="M7 7h.01"></path>
      </svg>
      <% 
        let tagCount = 0;
        post.tags.each(function(tag) {
          if (tagCount < 3) {
      %>
        <a href="<%- url_for(tag.path) %>"><%= tag.name %></a>
      <%
            tagCount++;
          }
        });
      %>
    </span>
  <% } %>

  <!-- 显示完整分类层级 -->
  <% if (post.categories && post.categories.length) { %>
    <span class="meta-item meta-categories">
      <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M20 7h-4.5L15 4H9L8.5 7H4v2h16V7z"></path>
        <path d="M4 11v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>
        <rect x="8" y="13" width="8" height="2"></rect>
      </svg>
      <% 
        // 如果是层级分类，显示完整路径
        if (post.categories.length === 1 && post.categories[0]?.children) {
          // 处理层级分类
          const category = post.categories[0];
          const path = [];
          let current = category;
          
          // 收集所有父级分类
          while (current) {
            path.unshift(current);
            current = current.parent;
          }
          
          // 显示完整路径
          path.forEach(function(cat, index) {
      %>
        <a href="<%- url_for(cat.path) %>"><%= cat.name %></a>
        <% if (index < path.length - 1) { %>
          <span class="meta-separator">/</span>
        <% } %>
      <%
          });
        } else {
          // 普通多分类
          post.categories.each(function(category, index) {
      %>
        <a href="<%- url_for(category.path) %>"><%= category.name %></a>
        <% if (index < post.categories.length - 1) { %>
          <span class="meta-separator">, </span>
        <% } %>
      <%
          });
        }
      %>
    </span>
  <% } %>
</div>
